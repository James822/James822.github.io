<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Creating a win32 Window and OpenGL Context on Windows From Scratch &middot; James Spratt</title>
    <meta name="title" content="Creating a win32 Window and OpenGL Context on Windows From Scratch &middot; James Spratt">
  

  
  
  
  
  
  <link rel="canonical" href="https://james822.github.io/posts/win32_window_opengl/">
  

  
  
    <meta name="author" content="James Spratt">
  
  
    
      
        
          <link href="JamesSpratt.business@protonmail.com" rel="me">
        
      
    
      
        
          <link href="https://github.com/james822" rel="me">
        
      
    
      
        
          <link href="https://linkedin.com/in/james-spratt-b4b619203" rel="me">
        
      
    
  

  
  <meta property="og:url" content="https://james822.github.io/posts/win32_window_opengl/">
  <meta property="og:site_name" content="James Spratt">
  <meta property="og:title" content="Creating a win32 Window and OpenGL Context on Windows From Scratch">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-02T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-02T00:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Creating a win32 Window and OpenGL Context on Windows From Scratch">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
    
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.66c506a5c4f6511d889183b31701ff2539c3b74c87f6941ac97de8ae693436d96d1a28c111af25968dc239d84011f367293a7f5707e3274c70dcdcd411a4d4c4.css"
    integrity="sha512-ZsUGpcT2UR2IkYOzFwH/JTnDt0yH9pQayX3ormk0NtltGijBEa8llo3COdhAEfNnKTp/VwfjJ0xw3NzUEaTUxA==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9df4fc14d50efcc9aa4cfc2b6f348e365f421f5ad491278f8f48c0360cf2f93f08882fda6da162d7ace8e5add57c2df4ac46bd3861306b1d4c452cd31f448d64.js"
      integrity="sha512-nfT8FNUO/MmqTPwrbzSONl9CH1rUkSePj0jANgzy&#43;T8IiC/abaFi16zo5a3VfC30rEa9OGEwax1MRSzTH0SNZA=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Creating a win32 Window and OpenGL Context on Windows From Scratch",
    "headline": "Creating a win32 Window and OpenGL Context on Windows From Scratch",
    
    
    "inLanguage": "en",
    "url" : "https://james822.github.io/posts/win32_window_opengl/",
    "author" : {
      "@type": "Person",
      "name": "James Spratt"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-05-02T00:00:00\u002b00:00",
    "datePublished": "2025-05-02T00:00:00\u002b00:00",
    
    "dateModified": "2025-05-02T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "7704"
  }]
  </script>



  
  
    




  

  
  

  
  

  
  

  
  
</head>


















  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          James Spratt
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Recent Posts"
  title="Posts">
  
  
    <p class="text-base font-medium">
      Recent Posts
    </p>
  
</a>



      
        
  <a
  href="/projects/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Projects"
  title="Projects">
  
  
    <p class="text-base font-medium">
      Projects
    </p>
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Recent Posts"
    title="Posts">
    
    
      <p class="text-bg font-bg">
        Recent Posts
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/projects/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Projects"
    title="Projects">
    
    
      <p class="text-bg font-bg">
        Projects
      </p>
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Creating a win32 Window and OpenGL Context on Windows From Scratch
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  

  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-05-02T00:00:00&#43;00:00">2 May 2025</time>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#win32">Win32</a></li>
    <li><a href="#documentation">Documentation</a></li>
    <li><a href="#compilingbuilding-on-windows-with-msvc">Compiling/Building on Windows with MSVC</a>
      <ul>
        <li><a href="#windows-sdk-and-installing-opengl-headers">Windows SDK and Installing (OpenGL) Headers</a></li>
        <li><a href="#starter-code-and-compilation-with-clexe-msvc">Starter Code and Compilation with cl.exe (MSVC)</a></li>
      </ul>
    </li>
    <li><a href="#dummy-windowcontext">Dummy Window/Context</a>
      <ul>
        <li><a href="#dummy-windowcontext-creation">Dummy Window/Context Creation</a></li>
        <li><a href="#loading-wgl-extension-procedures">Loading WGL Extension Procedures</a></li>
      </ul>
    </li>
    <li><a href="#window-procedure">Window Procedure</a></li>
    <li><a href="#creating-the-real-window-and-real-gl-context">Creating the Real Window and Real GL Context</a>
      <ul>
        <li><a href="#loading-wgl-extension-procedures-again">Loading WGL Extension Procedures (Again)</a></li>
        <li><a href="#loading-gl-procedures">Loading GL procedures</a></li>
      </ul>
    </li>
    <li><a href="#setting-up-hello-triangle">Setting up Hello Triangle</a>
      <ul>
        <li><a href="#main-eventmessage-loop--cleanup">Main Event/Message Loop &amp; Cleanup</a></li>
      </ul>
    </li>
    <li><a href="#source-code">Source Code</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#win32">Win32</a></li>
    <li><a href="#documentation">Documentation</a></li>
    <li><a href="#compilingbuilding-on-windows-with-msvc">Compiling/Building on Windows with MSVC</a>
      <ul>
        <li><a href="#windows-sdk-and-installing-opengl-headers">Windows SDK and Installing (OpenGL) Headers</a></li>
        <li><a href="#starter-code-and-compilation-with-clexe-msvc">Starter Code and Compilation with cl.exe (MSVC)</a></li>
      </ul>
    </li>
    <li><a href="#dummy-windowcontext">Dummy Window/Context</a>
      <ul>
        <li><a href="#dummy-windowcontext-creation">Dummy Window/Context Creation</a></li>
        <li><a href="#loading-wgl-extension-procedures">Loading WGL Extension Procedures</a></li>
      </ul>
    </li>
    <li><a href="#window-procedure">Window Procedure</a></li>
    <li><a href="#creating-the-real-window-and-real-gl-context">Creating the Real Window and Real GL Context</a>
      <ul>
        <li><a href="#loading-wgl-extension-procedures-again">Loading WGL Extension Procedures (Again)</a></li>
        <li><a href="#loading-gl-procedures">Loading GL procedures</a></li>
      </ul>
    </li>
    <li><a href="#setting-up-hello-triangle">Setting up Hello Triangle</a>
      <ul>
        <li><a href="#main-eventmessage-loop--cleanup">Main Event/Message Loop &amp; Cleanup</a></li>
      </ul>
    </li>
    <li><a href="#source-code">Source Code</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
  </div>
</details>



            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <p>In a <a
  href="/posts/x11_window_opengl/">previous post</a> I made a tutorial showing how to get a window open on linux/X11 with an OpenGL context. I&rsquo;d like to make the same tutorial but for windows now, so here it is.</p>
<p>This tutorial follows the same format as the last one, so I won&rsquo;t really go into too much detail on things that I&rsquo;ve already covered. I&rsquo;m moreso only going to outline the windows/win32 aspects here, but don&rsquo;t worry, the full source code is available <a
  href="https://github.com/James822/win32-opengl-window"
    target="_blank"
  >here</a> in my github repository.</p>
<p>Just like the last tutorial, we&rsquo;ll be using C to do everything, but you can also follow along in C++ with only a few modifications.</p>

<h2 class="relative group">Win32
    <div id="win32" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#win32" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Unlike linux, everything we&rsquo;ll need for this tutorial is under the win32 API. The win32 API is the programming interface to the windows operating system. It gives us the ability to perform file I/O, allocate memory, and namely: create windows.</p>
<p>As opposed to linux (or rather linux distributions), the windowing system is not seperate from the kernel or OS interface, but is provided as an integral part of win32. We&rsquo;ll shortly see the functions we can use to create and manage windows.</p>
<p>If you had already read my previous tutorial for making a window on linux with GLX and X11, then win32 essentially combines all these things together into one interface. The equivalent to GLX on windows is called &ldquo;WGL&rdquo;, or the &ldquo;Windows Extension to OpenGL&rdquo;. There is no equivalent to a windowing system like X11 or wayland, as the windowing system is an integral part of win32.</p>

<h2 class="relative group">Documentation
    <div id="documentation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#documentation" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>The primary source of documentation is MSDN (Microsoft Developer Network). Technically, MSDN was removed and integrated into a new space called &ldquo;Microsoft Learn&rdquo;, but everyone still refers to this portion of Microsoft Learn as what it used to be, which is MSDN.</p>
<p>Unfortunately, Microsft Learn/MSDN is very disorganized. I would provide you a link, but that would be more unhelpful than just providing a few select links on specific topics.</p>
<p>Along with MSDN, you should also have the <a
  href="https://registry.khronos.org/OpenGL/index_gl.php"
    target="_blank"
  >OpenGL registry</a> on hand.</p>

<h2 class="relative group">Compiling/Building on Windows with MSVC
    <div id="compilingbuilding-on-windows-with-msvc" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#compilingbuilding-on-windows-with-msvc" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>MSVC or the &ldquo;Microsoft Visual C++&rdquo; compiler is the main C/C++ compiler for windows which we will be using. Even though it only has &ldquo;C++&rdquo; in the title, it also supports C compilation. When it comes to microsoft, almost nothing is named what it should be, and everything seems to be almost deliberately confusing. Bear with me, as it only gets worse the further into it you go. Many of the MSDN docs will refer to &ldquo;C++&rdquo; tutorials or references, but these also apply to plain C as well.</p>
<p>MSVC is the compiler used in Visual Studio, and typically, people invoke it when they use the Visual Studio IDE. If you want to use VS that&rsquo;s up to you, but I&rsquo;ll demonstrate how to use MSVC from the command line directly which I find be easier to use, and it allows you to use whatever IDE you like. For this section, the primary reference will be this <a
  href="https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170"
    target="_blank"
  >MSDN documentation</a>.</p>
<p>The first thing you need to do is grab the &ldquo;Build Tools for Visual Studio&rdquo; which is referenced in the MSDN doc, and can be found <a
  href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022"
    target="_blank"
  >here</a>. This will give you the Visual Studio installer, which you should launch. You&rsquo;re going to want to select the &ldquo;Desktop development with C++&rdquo; install package, which is again poorly named, considering that it also gives us access to just plain C development tools. This install option is most likely all you&rsquo;ll need, but check the other options to see if you need something else. Again, just like we stated before, many of the tutorials/docs are named for C++ but are also for C as well, so don&rsquo;t worry.</p>
<p>In order for these build tools to work, a lot of environment variables need to be set correctly, which in my opinion is a very bad design decision on the behalf of windows. Thankfully, they at least provided a fix for this issue by giving us our choice of specific developer CMDs, or by using a vcvars&lt;&gt;.bat shell script to setup and configure any CMD for proper use in compiling with MSVC. We will go with the vcvars&lt;&gt;.bat option for this tutorial, but you can also just use one of the developer command prompts which does the same thing.</p>
<p>Unfortunately, all of these configurations and environment variables are specific to the machine/installation that you are building on, so you can&rsquo;t just copy the developer command prompts or vcvars&lt;&gt;.bat files over to another machine/installation and expect it to work, because it probably won&rsquo;t. So basically, this process needs to be repeated for each installation of windows. The vcvars&lt;&gt;.bat files can also vary from version to version, so from one VS version to the next, the location of the file and contents of the file might change. That being said, major version updates for VS don&rsquo;t come too often, but you should be looking to keep this process up to date at least a couple times or once per year.</p>
<p>The location of these vcvars&lt;&gt;.bat files is dependent, but I found mine for VS 2022 in the following location: <code>C:\Program Files (x86)\Microsoft Visual Studio\2022\BuildTools\VC\Auxiliary\Build</code>. The location can also be in many different places, such as the &ldquo;Progam Files&rdquo; without the x86, but this one is the correct one because it is under the &ldquo;BuildTools&rdquo; directory which corresponds to the Build Tools that I just referenced earlier in this tutorial for you to make sure to install. Again, windows is awful for this as there&rsquo;s multiple locations for these build files.</p>
<p>We&rsquo;ll use the <code>vcvars64.bat</code> one because according to the MSDN docs: &ldquo;Use the 64-bit x64-native tools to build 64-bit x64 code&rdquo;, so it builds us 64-bit code. DO NOT cut or copy this file anywhere else. These files are so delicate and I fear that even chaging the file location could screw it up because of how delicate these things are. The cwd doesn&rsquo;t seem to matter at least, but do not mess with these files as they are incredibly delicate as we will see soon.</p>
<p>Then, run the vcvars&lt;&gt;.bat file only ONCE in the CMD you are using, then you can use the MSVC compiler. The vcvars&lt;&gt;.bat files are NOT meant to be run any more than ONE time in a given CMD, otherwise they will screw up the PATH environment variable among other environment variables. They will just add to it instead of properly changing it, so you can only run ONE of these per CMD window/instance and not more than once. A good idea would be to write a script that sets a variable to see if it has been run in your CMD already, so that it only runs it once.</p>
<p>Once this is done in your CMD, MSVC is now avaible to run with &ldquo;cl&rdquo; or &ldquo;cl.exe&rdquo; as the compiler, and &ldquo;link&rdquo; or &ldquo;link.exe&rdquo; as the linker. These will be valid for the rest of the lifetime of the CMD you are in.</p>

<h3 class="relative group">Windows SDK and Installing (OpenGL) Headers
    <div id="windows-sdk-and-installing-opengl-headers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#windows-sdk-and-installing-opengl-headers" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Before we do anything else, we should also install headers.</p>
<p>The latest Windows SDK (also confusingly called &ldquo;Windows Kits&rdquo; for who knows what reason) is usually installed on your system when you install the Build Tools for Visual Studio as outlined above. The SDK contains many headers, such as the OpenGL headers, which we will need for this tutorial.</p>
<p>OpenGL extension headers are not included for whatever reason (glext.h, wglext.h, etc.), so you need to manually install them yourself. Any headers you want to install can be done manually with this method:</p>
<p>Find the location of the Windows SDK, which on my machine is installed in the location: <code>C:\Program Files (x86)\Windows Kits\</code>, which is confusing as they use the name &ldquo;Windows Kits&rdquo; instead of what should be &ldquo;Windows SDK&rdquo;.</p>
<p>I found the headers in the <code>C:\Program Files (x86)\Windows Kits\10\</code> subfolder which probably refers to Windows 10 (as that is the OS being used at the time of writing this post). The headers, library files, and many other important files are here for windows development.</p>
<p>For example, the OpenGL headers are in the location: <code>C:\Program Files (x86)\Windows Kits\10\Include\10.0.22621.0\um\gl\</code> where <code>10.0.22621.0</code> is the latest SDK that was installed when installing the Build Tools for Visual Studio. You can drag and drop extension headers such as <code>glext.h</code> or <code>wglext.h</code> in here, and then it will add it to your system headers which will be recognized as <code>&lt;gl/glext.h&gt;</code> and <code>&lt;gl/wglext.h&gt;</code>. (NOTE: Windows/NTFS doesn&rsquo;t care about case in filenames, so &ldquo;Windows.h&rdquo; = &ldquo;windows.h&rdquo; = &ldquo;WINDOWS.h&rdquo;, etc. By default, prefer lowercase).</p>
<p>You&rsquo;ll need to add the <code>khrplatform.h</code> header as well to your system as <code>glext.h</code> depends on <code>&lt;khr/khrplatform.h&gt;</code> being a valid location. This is easy, just create a <code>khr</code> folder in the <code>C:\Program Files (x86)\Windows Kits\10\Include\10.0.22621.0\um\</code> directory and then place the <code>khrplatform.h</code> file in that folder so that the location looks like this: <code>C:\Program Files (x86)\Windows Kits\10\Include\10.0.22621.0\um\khr\khrplatform.h</code>. Then, the system include <code>&lt;khr/khrplatform.h&gt;</code> or equivalently <code>&lt;KHR/khrplatform.h&gt;</code> will be recognized by MSVC.</p>
<p>You can also just place your headers in your local project folder, and then add the path to MSVC with the <code>/I</code> flag, but I prefer this method with installing it manually in the Windows SDK (or &ldquo;Windows Kits&rdquo;) location as it keeps it all in one place, and is current to the specific version of the SDK you use. If you get a new SDK version, you&rsquo;ll need to repeat this process.</p>

<h3 class="relative group">Starter Code and Compilation with cl.exe (MSVC)
    <div id="starter-code-and-compilation-with-clexe-msvc" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#starter-code-and-compilation-with-clexe-msvc" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Once you have the headers installed and a CMD open and have run the vcvars&lt;&gt;.bat file (or if you have a developer command prompt, which does the same thing), type <code>cl</code> or <code>cl.exe</code> in your CMD and you should get output like this:</p>
<pre tabindex="0"><code>Microsoft (R) C/C++ Optimizing Compiler Version 19.43.34809 for x64
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ]
</code></pre><p>Otherwise, if you get some kind of error like this:</p>
<pre tabindex="0"><code>&#39;cl&#39; is not recognized as an internal or external command,
operable program or batch file.
</code></pre><p>Then that means you haven&rsquo;t run the vcvars&lt;&gt;.bat file (or you aren&rsquo;t using a developer CMD).</p>
<p>Once you have cl.exe available and ready, we can finally compile a basic starter &ldquo;Hello World&rdquo; program to make sure everything is setup correctly. Start with this C code and name it something like &ldquo;win32_window.c&rdquo;:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">Windows window and WGL/OpenGL example program.
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ we have to ignore all these errors because the windows.h header itself won&#39;t even compile without error with &#34;/Wall&#34; in MSVC, which is quite ironic that microsoft&#39;s own headers don&#39;t compile without warning in their compiler. */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#pragma warning( push )
</span></span></span><span class="line"><span class="cl"><span class="cp">#pragma warning( disable : 4668 )
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;windowsx.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#pragma warning( pop )
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;gl/gl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cm">/* these two headers need to manually installed, windows only provides &#34;gl/gl.h&#34; as part of the Windows SDK (installed when you install the Build Tools for Visual Studio). You can grab both of these headers from the OpenGL registry: https://registry.khronos.org/OpenGL/index_gl.php */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;gl/glext.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;gl/wglext.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Hello World!</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">      <span class="n">HINSTANCE</span> <span class="n">hInstance</span> <span class="o">=</span> <span class="nf">GetModuleHandleA</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span> <span class="cm">/* since we aren&#39;t using wWinMain() or WinMain(), we need to grab the HINSTANCE with this function. */</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">program_running</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">fullscreen</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* set to &#39;1&#39; if you want fullscreen, &#39;0&#39; if you don&#39;t */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="cm">/* @@ user variables */</span>
</span></span><span class="line"><span class="cl">      <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">window_name</span> <span class="o">=</span> <span class="s">&#34;win32 window&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">window_width</span> <span class="o">=</span> <span class="mi">960</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">window_height</span> <span class="o">=</span> <span class="mi">540</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>then, compile with this command:</p>
<pre tabindex="0"><code>cl User32.lib Gdi32.lib Opengl32.lib win32_window.c
</code></pre><p>Then run it with:</p>
<pre tabindex="0"><code>win32_window.exe
</code></pre><p>and you should get &ldquo;Hello World!&rdquo; as output in your CMD.</p>
<p>The libraries <code>User32.lib</code>, <code>Gdi32.lib</code>, and <code>Opengl32.lib</code> are all required for what we are going to do. <code>User32.lib</code> is neccessary for some basic win32 functions, and the remaining two are necessary for creating an OpenGL context.</p>

<h2 class="relative group">Dummy Window/Context
    <div id="dummy-windowcontext" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#dummy-windowcontext" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Before we jump into anything else, I need to make something clear about a certain quirk on windows that you need to be aware of when it comes to OpenGL.</p>
<p>For 2 reasons on windows, it is neccessary to create both a &ldquo;dummy&rdquo; window &amp; GL context. We will need to first create the dummy window, get a dummy (legacy) OpenGL context, and then use that dummy GL context to load the necessary extension procedures to create a modern core-profile GL context.</p>
<p>The procedure that we need to create a modern core-profile OpenGL context is mainly <code>wglCreateContextAttribsARB</code>, and also a few others. The problem here is that we can&rsquo;t load these extension procedures unless we <em>already</em> have an OpenGL context! The procedure loading function on windows is <code>wglGetProcAddress</code>, and it requires a context to be current in order to function properly. In fact, the MSDN docs say that the function pointers returned by <code>wglGetProcAddress</code> are only valid given a current-context, and it may not be valid for any other contexts.</p>
<p>So how do we solve this apparent Catch-22? The answer is that we are still able to create a <em>legacy</em> OpenGL context as windows provides legacy GL functions to do so, namely <code>wglCreateContext</code>. Once we have this GL context and have made it current, we can then use it to query for and load procedures that we use to create the new or <em>modern</em> OpenGL context, and then we can get rid of the old one.</p>
<p>Along with that, windows only allows us to set the pixel format of a window once. If we want to change the pixel format of window, we can&rsquo;t. The only way to change pixel formats is to create a new window. Since it is required to set a pixel format for a window to get an OpenGL context, we need to set the pixel format of the window and <em>then</em> use that window to create the dummy (legacy) GL context. This would be all fine, except that modern GL context creation has extended pixel formats that we will want to support, with extension functions provided such as <code>wglChoosePixelFormatARB</code> to give us more options for pixel formats. So because of all those reasons, we also find it necessary to create a new window to take advantage of new pixel formats that come with modern GL.</p>
<p>So in short, because of both the nature of loading procedures requiring an existing context AND pixel formats only being able to be set once; we need a dummy window AND a dummy GL context, of which both we will destroy once we have the &ldquo;real&rdquo; window and &ldquo;real&rdquo; GL context.</p>

<h3 class="relative group">Dummy Window/Context Creation
    <div id="dummy-windowcontext-creation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#dummy-windowcontext-creation" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Finally we can start doing some real work!</p>
<p>In order to create the dummy window and dummy GL context, you can use this code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ creating dummy GL window */</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">dummygl_window_class_name</span> <span class="o">=</span> <span class="s">&#34;DUMMYGL_WINDOW_CLASS&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">WNDCLASSA</span> <span class="n">dummygl_wnd_class</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">CS_OWNDC</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">lpfnWndProc</span> <span class="o">=</span> <span class="n">DummyGL_WindowProc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">cbClsExtra</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">cbWndExtra</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">hInstance</span> <span class="o">=</span> <span class="n">hInstance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">hIcon</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">hCursor</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">hbrBackground</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">lpszMenuName</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_wnd_class</span><span class="p">.</span><span class="n">lpszClassName</span> <span class="o">=</span> <span class="n">dummygl_window_class_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">RegisterClassA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dummygl_wnd_class</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: RegisterClassA() failed to register window class: %s - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">dummygl_window_class_name</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HWND</span> <span class="n">dummygl_window_handle</span> <span class="o">=</span> <span class="nf">CreateWindowA</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="n">dummygl_window_class_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="s">&#34;dummygl_window&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">WS_DISABLED</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">hInstance</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">dummygl_window_handle</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: CreateWindowA() failed to create dummygl window - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HDC</span> <span class="n">dummygl_DC</span> <span class="o">=</span> <span class="nf">GetDC</span><span class="p">(</span><span class="n">dummygl_window_handle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">dummygl_DC</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: GetDC() failed to get DC for dummygl window</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ creating dummy GL context */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* it doesn&#39;t matter what the pixel format descriptor members are, just as long as this gets us a context, so we just pick members that would give us a high chance of getting a context on every possible system */</span>
</span></span><span class="line"><span class="cl"><span class="n">PIXELFORMATDESCRIPTOR</span> <span class="n">dummygl_pfd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">nSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PIXELFORMATDESCRIPTOR</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">nVersion</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">dwFlags</span> <span class="o">=</span> <span class="n">PFD_DRAW_TO_WINDOW</span> <span class="o">|</span> <span class="n">PFD_SUPPORT_OPENGL</span> <span class="o">|</span> <span class="n">PFD_DOUBLEBUFFER</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">iPixelType</span> <span class="o">=</span> <span class="n">PFD_TYPE_RGBA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cColorBits</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cRedBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cRedShift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cGreenBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cGreenShift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cBlueBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cBlueShift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAlphaBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAlphaShift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAccumBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAccumRedBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAccumGreenBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAccumBlueBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAccumAlphaBits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cDepthBits</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cStencilBits</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">cAuxBuffers</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">iLayerType</span> <span class="o">=</span> <span class="n">PFD_MAIN_PLANE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">bReserved</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">dwLayerMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">dwVisibleMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dummygl_pfd</span><span class="p">.</span><span class="n">dwDamageMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">dummygl_pixelformat_index</span> <span class="o">=</span> <span class="nf">ChoosePixelFormat</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dummygl_pfd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">dummygl_pixelformat_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: ChoosePixelFormat() failed to get a pixel format that matched - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">SetPixelFormat</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">,</span> <span class="n">dummygl_pixelformat_index</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dummygl_pfd</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: SetPixelFormat() failed to set the pixel format - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HGLRC</span> <span class="n">dummygl_context</span> <span class="o">=</span> <span class="nf">wglCreateContext</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">dummygl_context</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglCreateContext() failed to create a dummy GL context - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglMakeCurrent</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">,</span> <span class="n">dummygl_context</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglMakeCurrent() failed to make context current - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>The first we thing we need to do is create a window class for the dummy window and register it with <code>RegisterClassA()</code>. Window classes in win32 are basically just window information for a window class, they don&rsquo;t really serve much of a purpose beyond the fact that they can be reused across more than one window. We won&rsquo;t be doing such thing, so we&rsquo;ll create the window class for our dummy window.</p>
<p>We also need to pass in a pointer to the <code>RegisterClassA()</code> function that specifies something called the &ldquo;window procedure&rdquo;, a special callback that we must register for each window. This window callback is a function called by the OS which receives all kinds of events or messages that we need to handle.</p>
<p>Since this is a dummy window that we will destroy, we don&rsquo;t actually need to worry about how to handle the window procedure so much, so we can just write the function with <code>DefWindowProc()</code> which is the &ldquo;default window procedure&rdquo; provided to us by win32 that automatically handles every message:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="nf">DummyGL_WindowProc</span><span class="p">(</span><span class="n">HWND</span> <span class="n">hwnd</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nf">DefWindowProc</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Then, we can pass <code>DummyGL_WindowProc</code> to the <code>RegisterClassA()</code> which will register this window callback to the one used for any windows created with this window class. We will go over what the Window Procedure is and how to write it in more detail later, but for the dummy window, we just need default behaviour as we&rsquo;ll never actually use the window for anything else besides getting a context. The user of this application will never see the dummy window.</p>
<p>Next, we then create the dummy window with <code>CreateWindowA()</code>, and we also grab the window DC (device context) which is necessary for context creation.</p>
<p>To create an OpenGL context in windows, we need to first set a pixel format. We choose it first with <code>ChoosePixelFormat()</code>, and then set it with <code>SetPixelFormat()</code> which is set per-window. Even though we pass in the device context to this function, it refers to our window.</p>
<p>Right from the <a
  href="https://learn.microsoft.com/en-us/windows/win32/api/wingdi/nf-wingdi-setpixelformat"
    target="_blank"
  >MSDN docs</a>:</p>
<blockquote>
<p>If hdc references a window, calling the SetPixelFormat function also changes the pixel format of the window. Setting the pixel format of a window more than once can lead to significant complications for the Window Manager and for multithread applications, so it is not allowed. An application can only set the pixel format of a window one time. Once a window&rsquo;s pixel format is set, it cannot be changed.</p>
</blockquote>
<p>So this is what is behind the reason for needing a dummy window, as we will see that when we load the extension procedures for extension pixel formats, we need a fresh window to set a new pixel format.</p>
<p>The next thing we do after that is create the dummy context with the wgl function <code>wglCreateContext()</code> which just takes in our window DC. Then, we need to make it current with <code>wglMakeCurrent()</code> so that we can start loading procedures.</p>

<h3 class="relative group">Loading WGL Extension Procedures
    <div id="loading-wgl-extension-procedures" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#loading-wgl-extension-procedures" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Now that we have our (legacy) dummy GL context, we can load the important procedures that will be neccessary for a modern core-profile GL context.</p>
<p>There are three extensions that we need to create a new context: <code>WGL_ARB_extensions_string</code>, <code>WGL_ARB_pixel_format</code>, and <code>WGL_ARB_create_context_profile</code>.</p>
<p>The first extension, <code>WGL_ARB_extensions_string</code>, is important as it gives us the procedure <code>wglGetExtensionsStringARB()</code> which gives us the ability to query what extensions are available.</p>
<p>Unfortunately, due to some oversight, <code>wglGetExtensionsStringARB()</code> is not provided statically, so we just have to load it and hope that it is present, otherwise we have no ability to query what extensions are available. This is also another Catch-22 situation, as we need the <code>wglGetExtensionsStringARB()</code> function to be present in order to query if extensions are present, including <code>WGL_ARB_extensions_string</code>. GLX handles this much better as there is a statically provided <code>glXQueryExtensionsString</code> which does the same thing.</p>
<p>So, we just try to load <code>wglGetExtensionsStringARB()</code> and hope that it is available. As for <em>how</em> to load extension procedures, we use the wgl function <code>wglGetProcAddress()</code>.</p>
<p><code>wglGetProcAddress()</code> apparently does not function as documented in MSDN, as according to this <a
  href="https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions"
    target="_blank"
  >Khronos wiki entry</a>:</p>
<blockquote>
<p>While the MSDN documentation says that wglGetProcAddress returns NULL on failure, some implementations will return other values. 1, 2, and 3 are used, as well as -1.</p>
</blockquote>
<p>So, we wrap <code>wglGetProcAddress()</code> in our function <code>Load_WGL_Proc()</code> like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* Loads the specified GL/WGL function with the name &#34;proc_name&#34; using wglGetProcAddress(). Returns NULL on failure, otherwise non-NULL for success.
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span><span class="o">*</span> <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">proc_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">void</span><span class="o">*</span> <span class="n">proc</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">proc</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="nf">wglGetProcAddress</span><span class="p">(</span><span class="n">proc_name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="n">proc</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">proc</span> <span class="o">==</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mi">1</span> <span class="o">||</span> <span class="n">proc</span> <span class="o">==</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mi">2</span> <span class="o">||</span> <span class="n">proc</span> <span class="o">==</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mi">3</span> <span class="o">||</span> <span class="n">proc</span> <span class="o">==</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">proc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>We also need a function to parse the extension string as it is a space-seperated list of extensions names (there are no spaces in an extension name). In python, this might be a simple one-liner, but in C, it takes a bit more work. My implementation is here, I call the function <code>Check_Extension_Available()</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* Returns 1 if extension is available, otherwise 0 if it is not present.
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">This function expects &#34;extensions_lists&#34; to be a space seperated list of GL (or platform, e.g. WGL/GLX) extensions, and it searches extensions_lists to find if the extension &#34;extensions&#34; is within it.
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">int</span> <span class="nf">Check_Extension_Available</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">extensions_list</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">extension</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="k">while</span><span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="k">if</span><span class="p">(</span><span class="n">c</span> <span class="o">==</span> <span class="n">extension</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* i &gt; 0 (i != 0) means we need to ensure the previous char is a space */</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39; &#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		  <span class="cm">/* now we check to see if the rest of the string after matches */</span>
</span></span><span class="line"><span class="cl">		  <span class="kt">int</span> <span class="n">equal</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		  <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		  <span class="k">while</span><span class="p">(</span><span class="n">extension</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			      <span class="n">equal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span><span class="p">(</span><span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">extension</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			      <span class="n">equal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			      <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		  <span class="p">}</span>
</span></span><span class="line"><span class="cl">		  
</span></span><span class="line"><span class="cl">		  <span class="k">if</span><span class="p">(</span><span class="n">equal</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span> <span class="o">||</span> <span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		  <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="n">c</span> <span class="o">=</span> <span class="n">extensions_list</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>I don&rsquo;t claim this is the best or most secure, it&rsquo;s just what I quickly wrote up.</p>
<p>Now that we have that, we can finally load the procedures:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ loading extensions to create our real Gl context. Now that we have a dummy context, we can load the necessary extension procedures in order to create the real context. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* the procedure wglGetExtensionsStringARB() is used to query extensions, but since it is itself part of an extension (WGL_ARB_extensions_string), we can&#39;t use the procedure to query itself before we even know if it exists. So, we just have to try to load it. */</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLGETEXTENSIONSSTRINGARBPROC</span> <span class="n">wglGetExtensionsStringARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wglGetExtensionsStringARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLGETEXTENSIONSSTRINGARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglGetExtensionsStringARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglGetExtensionsStringARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load wglGetExtensionsStringARB()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">extensions_string</span> <span class="o">=</span> <span class="nf">wglGetExtensionsStringARB</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">extensions_string</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglGetExtensionsStringARB() failed to get the extensions string - win32 (or or WGL_ARB_extensions_string extension) error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">Check_Extension_Available</span><span class="p">(</span><span class="n">extensions_string</span><span class="p">,</span> <span class="s">&#34;WGL_ARB_pixel_format&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: WGL_ARB_pixel_format extension not found</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">Check_Extension_Available</span><span class="p">(</span><span class="n">extensions_string</span><span class="p">,</span> <span class="s">&#34;WGL_ARB_create_context_profile&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: WGL_ARB_create_context_profile extension not found</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* These procedure pointers are neccessary to aquire/load in the dummy context, but the remainder of the WGL (and GL) extension procedures should be loaded with the actual context. wglGetExtensionsStringARB() should be loaded again with the new context, but these ones are only neccessary to for context creation, so we don&#39;t need them again. */</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLGETPIXELFORMATATTRIBIVARBPROC</span> <span class="n">wglGetPixelFormatAttribivARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLGETPIXELFORMATATTRIBFVARBPROC</span> <span class="n">wglGetPixelFormatAttribfvARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLCHOOSEPIXELFORMATARBPROC</span> <span class="n">wglChoosePixelFormatARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLCREATECONTEXTATTRIBSARBPROC</span> <span class="n">wglCreateContextAttribsARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">wglGetPixelFormatAttribivARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLGETPIXELFORMATATTRIBIVARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglGetPixelFormatAttribivARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wglGetPixelFormatAttribfvARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLGETPIXELFORMATATTRIBFVARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglGetPixelFormatAttribfvARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wglChoosePixelFormatARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLCHOOSEPIXELFORMATARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglChoosePixelFormatARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wglCreateContextAttribsARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLCREATECONTEXTATTRIBSARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglCreateContextAttribsARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglGetPixelFormatAttribivARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglGetPixelFormatAttribivARB</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglGetPixelFormatAttribfvARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglGetPixelFormatAttribfvARB</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglChoosePixelFormatARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglChoosePixelFormatARB</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglCreateContextAttribsARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglCreateContextAttribsARB</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>The second extension: <code>WGL_ARB_pixel_format</code>, gives us the procedures needed to create new types of pixel formats mainly with the procedure: <code>wglChoosePixelFormatARB()</code>.</p>
<p>The third extensions: <code>WGL_ARB_create_context_profile</code>, gives us the important function <code>wglCreateContextAttribsARB()</code> which is what is used to actually create the modern core-profile OpenGL context.</p>
<p>Now we are ready to create the real GL context!</p>

<h2 class="relative group">Window Procedure
    <div id="window-procedure" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#window-procedure" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Before we do indeed create the real window and real GL context, we need to revisit the window procedure.</p>
<p>Unfortunately, win32 is designed in a way so that it is necessary to have a window procedure callback that you must define so that it can handle potentially <em>thousands</em> of different kinds of messages. A typical window procedure might look like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="nf">WindowProc</span><span class="p">(</span><span class="n">HWND</span> <span class="n">hwnd</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span><span class="n">uMsg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">WM_DESTROY</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">PostQuitMessage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="nl">WM_PAINT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">PAINTSTRUCT</span> <span class="n">ps</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">HDC</span> <span class="n">hdc</span> <span class="o">=</span> <span class="nf">BeginPaint</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ps</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// All painting occurs here, between BeginPaint and EndPaint.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">            <span class="nf">FillRect</span><span class="p">(</span><span class="n">hdc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ps</span><span class="p">.</span><span class="n">rcPaint</span><span class="p">,</span> <span class="p">(</span><span class="n">HBRUSH</span><span class="p">)</span> <span class="p">(</span><span class="n">COLOR_WINDOW</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nf">EndPaint</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ps</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nf">DefWindowProc</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>where you either decide to intercept messages yourself, or let them be handled by the Default Window Procedure <code>DefWindowProc()</code>.</p>
<p>Microsoft doesn&rsquo;t even document these messages properly, with their documentation being scattered all over MSDN and not in a central place. Luckily, the folks over at WINE have taken it upon themselves do to so which can be found <a
  href="https://gitlab.winehq.org/wine/wine/-/wikis/Wine-Developer%27s-Guide/List-of-Windows-Messages"
    target="_blank"
  >here</a>.</p>
<p>What&rsquo;s not so great is that the window procedure can be called by windows (the OS) at <em>any time</em> and there is no way of predicting when! Rather than just having a simple message loop that blocks until it gets messages, the creators behind win32 also opted to go for a callback design with the window procedure message, which is nothing less than an awful design choice no matter what historical context prompted it.</p>
<p>The window procedure can either be called in the message loop by <code>DispatchMessage()</code>, which is a function we will call (we&rsquo;ll get to the message loop later), OR, it can be called at any point by the OS. There are essentially two different event-handling paradigms (callback/queued) that are both present in win32. This is the worst of both worlds, not the best.</p>
<p>There is also absolutely no clear and cut way to know what messages you should handle, whether you should intercept some and handle completely yourself, or if you should handle it and <i>then</i> pass it to the default window procedure - OR - if you should only use the default window procedure period. Since we don&rsquo;t have the source code for <code>DefWindowProc()</code>, half the time we just have to guess what it does, as most of the documentation for it is in the MSDN description for a message and is usually vague and somtimes completely absent.</p>
<p>What&rsquo;s even worse is that if you choose not to handle some messages, your window or application will break in completely unpredictable ways, as the message model that win32 operates on is very odd in several places. Sometimes messages will be passed in for purely informational purposes (such as when a window is created), but you still have to return a specific value otherwise certain functions will break (such as <code>CreateWindow()</code>).</p>
<p>What the OS is essentially doing is &ldquo;recruiting&rdquo; our process (specifically the thread the window was created in) to do the window processing that it should be handling itself. This is a terrible design decision and could have only ever been cooked up by microsoft. It is overly complex and very error-prone, with absolutely no benefit.</p>
<p>Rather than handling it in the OS (where it should be) a lot of critical default behaviour is offloaded onto your thread, which causes unexpected behaviour that can be bad in very subtle ways. See this <a
  href="https://github.com/libsdl-org/SDL/issues/1059"
    target="_blank"
  >link</a> for example of how much of a headache this caused for the folks at SDL. This is just one particular example.</p>
<p>All of this <em>might</em> be acceptable if it was well-documented exactly what the default window procedure does, as we are essentially forced into calling it on our own process thread, rather than the OS handling itself (which it should). But of course, as we would expect, the documentation for <code>DefWindowProc()</code> is spread out all over MSDN for each message (there are thousands of messages!). Most of the time, only vague descriptions are given as to what the default window procedure does, which is next to useless.</p>
<p>Thankfully, the folks at WINE have once again come to the rescue and they have reverse engineered the default window procedure which can be found <a
  href="https://gitlab.winehq.org/wine/wine/-/blob/master/dlls/win32u/defwnd.c#L2388"
    target="_blank"
  >here</a>.</p>
<p>To deal with all of this nonsense, we basically just have to call the default window procedure, and try to figure out which cases we need to handle ourselves. This is a tedious trial-and-error process and is unfortunately the only way to go. Once again, absolutely terrible design on the behalf of microsoft.</p>
<p>On the bright side, we can learn from existing codebases (such as the reverse-engineered one in WINE) for how to write our window procedures.</p>
<p>The implementation we will use for this tutorial is given here:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* main window procedure for our win32 window */</span>
</span></span><span class="line"><span class="cl"><span class="n">LRESULT</span> <span class="n">CALLBACK</span> <span class="nf">WindowProc</span><span class="p">(</span><span class="n">HWND</span> <span class="n">hwnd</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">WPARAM</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">LPARAM</span> <span class="n">lParam</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* printf(&#34;MSG CODE: %u\n&#34;, uMsg); */</span>
</span></span><span class="line"><span class="cl">      <span class="n">LRESULT</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">switch</span> <span class="p">(</span><span class="n">uMsg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @@ these are messages that we want to process ourselves */</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_PAINT</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_PAINT</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">ValidateRect</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span> <span class="cm">/* validates the entire client region of the window so that the OS doesn&#39;t keep spamming WM_PAINT messages and thus stalling our application message loop. */</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_CLOSE</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_CLOSE</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">PostQuitMessage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @@ mouse input */</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_LBUTTONDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_LBUTTONDOWN</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_LBUTTONUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_LBUTTONUP</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_MBUTTONDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_MBUTTONDOWN</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_MBUTTONUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_MBUTTONUP</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_RBUTTONDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_RBUTTONDOWN</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_RBUTTONUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_RBUTTONUP</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_XBUTTONDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_XBUTTONDOWN: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="k">if</span><span class="p">(</span><span class="nf">GET_XBUTTON_WPARAM</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">XBUTTON1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;XBUTTON1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nf">GET_XBUTTON_WPARAM</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">XBUTTON2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;XBUTTON2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_XBUTTONUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_XBUTTONUP: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="k">if</span><span class="p">(</span><span class="nf">GET_XBUTTON_WPARAM</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">XBUTTON1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;XBUTTON1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nf">GET_XBUTTON_WPARAM</span><span class="p">(</span><span class="n">wParam</span><span class="p">)</span> <span class="o">==</span> <span class="n">XBUTTON2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;XBUTTON2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_MOUSEMOVE</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_MOUSEMOVE</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="kt">int</span> <span class="n">x_pos</span> <span class="o">=</span> <span class="nf">GET_X_LPARAM</span><span class="p">(</span><span class="n">lParam</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="kt">int</span> <span class="n">y_pos</span> <span class="o">=</span> <span class="nf">GET_Y_LPARAM</span><span class="p">(</span><span class="n">lParam</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_MOUSEWHEEL</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_MOUSEWHEEL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @@ keyboard Input */</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_SYSKEYDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_SYSKEYDOWN</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_SYSKEYUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_SYSKEYUP</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_KEYDOWN</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_KEYDOWN</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="k">if</span><span class="p">(</span><span class="n">wParam</span> <span class="o">==</span> <span class="n">VK_ESCAPE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="cm">/* quit if user presses the ESC key */</span>
</span></span><span class="line"><span class="cl">		  <span class="nf">PostQuitMessage</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_KEYUP</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_KEYUP</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_CHAR</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_CHAR</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="nl">WM_SYSCHAR</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;WM_SYSCHAR</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="cm">/* @!*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="k">default</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="n">result</span> <span class="o">=</span> <span class="nf">DefWindowProc</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span> <span class="n">uMsg</span><span class="p">,</span> <span class="n">wParam</span><span class="p">,</span> <span class="n">lParam</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	    <span class="cm">/* result = 0; */</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>This minimal implementation has empty cases for all kinds of keyboard input and mouse input. The <code>WM_PAINT</code> message in particular is handled ourselves as we don&rsquo;t want the default procedure painting our window. Since we will be using OpenGL for graphics, we only call <code>ValidateRect()</code> to let the OS know that the whole window reigon is &ldquo;validated&rdquo; so that it won&rsquo;t continue to spam more <code>WM_PAINT</code> and stall our application.</p>

<h2 class="relative group">Creating the Real Window and Real GL Context
    <div id="creating-the-real-window-and-real-gl-context" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#creating-the-real-window-and-real-gl-context" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Now we can finally create the real window and real GL context!</p>
<p>To do so, use this code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ Creating the real window */</span>
</span></span><span class="line"><span class="cl"><span class="n">WNDCLASSEXA</span> <span class="n">wnd_class</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">window_class_name</span> <span class="o">=</span> <span class="s">&#34;WINDOW_CLASS&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">cbSize</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">WNDCLASSEXA</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">CS_OWNDC</span><span class="p">;</span> <span class="cm">/* it&#39;s probably neccessary to set CS_OWNDC flag for OpenGL context creation */</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">lpfnWndProc</span> <span class="o">=</span> <span class="n">WindowProc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">cbClsExtra</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">cbWndExtra</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">hInstance</span> <span class="o">=</span> <span class="n">hInstance</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">hIcon</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">hCursor</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">hbrBackground</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">lpszMenuName</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">lpszClassName</span> <span class="o">=</span> <span class="n">window_class_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wnd_class</span><span class="p">.</span><span class="n">hIconSm</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">RegisterClassExA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">wnd_class</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: RegisterClassA() failed to register window class - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HWND</span> <span class="n">window_handle</span> <span class="o">=</span> <span class="nf">CreateWindowExA</span>
</span></span><span class="line"><span class="cl">      <span class="p">(</span><span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">window_class_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">window_name</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">WS_OVERLAPPEDWINDOW</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">CW_USEDEFAULT</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">window_width</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">window_height</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="n">hInstance</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">       <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">window_handle</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: CreateWindowExA() failed to create window - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HDC</span> <span class="n">window_DC</span> <span class="o">=</span> <span class="nf">GetDC</span><span class="p">(</span><span class="n">window_handle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">window_DC</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: GetDC() failed to get DC for window</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ creating the real Gl context */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define PI_ATTRIB_LIST_LENGTH 19
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="n">pi_attrib_list</span><span class="p">[</span><span class="n">PI_ATTRIB_LIST_LENGTH</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_DRAW_TO_WINDOW_ARB</span><span class="p">;</span> <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_SUPPORT_OPENGL_ARB</span><span class="p">;</span> <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_DOUBLE_BUFFER_ARB</span><span class="p">;</span>  <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_PIXEL_TYPE_ARB</span><span class="p">;</span>     <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_TYPE_RGBA_ARB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_ACCELERATION_ARB</span><span class="p">;</span>   <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>  <span class="o">=</span> <span class="n">WGL_FULL_ACCELERATION_ARB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_COLOR_BITS_ARB</span><span class="p">;</span>     <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_ALPHA_BITS_ARB</span><span class="p">;</span>     <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_DEPTH_BITS_ARB</span><span class="p">;</span>     <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_STENCIL_BITS_ARB</span><span class="p">;</span>   <span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_attrib_list</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* look into WGL_SAMPLE_BUFFERS_ARB for MSAA */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">pixel_format_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">UINT</span> <span class="n">num_formats</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglChoosePixelFormatARB</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="n">pi_attrib_list</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pixel_format_id</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num_formats</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to get pixel format with wglChoosePixelFormatARB() - win32 (or WGL_ARB_pixel_format extension) error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">num_formats</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: no pixel formats found as queried with wglChoosePixelFormatARB()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PIXELFORMATDESCRIPTOR</span> <span class="n">pixel_fd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">DescribePixelFormat</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="n">pixel_format_id</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PIXELFORMATDESCRIPTOR</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">pixel_fd</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: DescribePixelFormat() failed - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">SetPixelFormat</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="n">pixel_format_id</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pixel_fd</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to set pixel format with SetPixelFormat() - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">#define ATTRIB_LIST_LENGTH 7
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="n">attrib_list</span><span class="p">[</span><span class="n">ATTRIB_LIST_LENGTH</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">attrib_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_CONTEXT_MAJOR_VERSION_ARB</span><span class="p">;</span> <span class="n">attrib_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">attrib_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_CONTEXT_MINOR_VERSION_ARB</span><span class="p">;</span> <span class="n">attrib_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">attrib_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_CONTEXT_PROFILE_MASK_ARB</span><span class="p">;</span> <span class="n">attrib_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">WGL_CONTEXT_CORE_PROFILE_BIT_ARB</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">attrib_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">HGLRC</span> <span class="n">wgl_context</span> <span class="o">=</span> <span class="nf">wglCreateContextAttribsARB</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">attrib_list</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wgl_context</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to create WGL (GL) context - win32 (or WGL_ARB_create_context/WGL_ARB_create_context_profile extension) error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ cleanup of dummygl stuff */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglMakeCurrent</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* making dummy GL context not current */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglMakeCurrent() failed to make context NOT current</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglDeleteContext</span><span class="p">(</span><span class="n">dummygl_context</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* deleting dummy GL context */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglDeleteContext() failed to delete the dummy GL context</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">DeleteDC</span><span class="p">(</span><span class="n">dummygl_DC</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* deleting dummy GL device context */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: DeleteDC() failed to delete the dummy GL Device Context</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">DestroyWindow</span><span class="p">(</span><span class="n">dummygl_window_handle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* destroying dummy GL window */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: DestroyWindow() failed to destroy the dummy GL window</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">UnregisterClassA</span><span class="p">(</span><span class="n">dummygl_window_class_name</span><span class="p">,</span> <span class="n">hInstance</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* unregistering dummy GL window class */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: UnregisterClassA() failed to unregister the dummy GL window class: %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">dummygl_window_class_name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ now we make the real context current, the WGL context */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglMakeCurrent</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="n">wgl_context</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglMakeCurrent() failed to make context current</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>Creating the window is the same as before, except that this is the real window so you want to set properties knowing that it&rsquo;s the one that will be visible. After window creation, we grab the window DC again which will be used in creation of the real context.</p>
<p>Now, we can create the new GL context which is where our new extensions come into play.</p>
<p>We need to specify an attribute list: <code>pi_attrib_list</code>, which we set to have a number of important properties. This attribute list will be used in creation of our new pixel format with the <code>wglChoosePixelFormatARB()</code> function, and is the main reason why we needed this extension function in the first place. With this attribute list we can also choose double buffering and/or MSAA, which was not possible with the legacy context.</p>
<p>Then, we use <code>DescribePixelFormat()</code> to get a pixel descriptor, and then pass that to <code>SetPixelFormat()</code> so that we can finally set the pixel format for this window.</p>
<p>We then create the context with <code>wglCreateContextAttribsARB()</code> which we loaded prior, passing in an attribute list to specify the version of OpenGL we will be using and some other things.</p>
<p>Once we are done that, we cleanup the old dummy window and dummy context as we no longer need it. Right after that, we finally make the new GL context current with <code>wglMakeCurrent()</code> and now we have a modern OpenGL context created current to our thread!</p>
<p>Technically we&rsquo;re done at this point as we have a modern GL context now, but there&rsquo;s still more to go over.</p>

<h3 class="relative group">Loading WGL Extension Procedures (Again)
    <div id="loading-wgl-extension-procedures-again" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#loading-wgl-extension-procedures-again" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Now that we have a new context, we should reload any procedures that we had in the previous context. This is a matter of good practice, as according to the <a
  href="https://learn.microsoft.com/en-us/windows/win32/api/wingdi/nf-wingdi-wglgetprocaddress"
    target="_blank"
  >MSDN documentation</a>:</p>
<blockquote>
<p>The OpenGL library supports multiple implementations of its functions. Extension functions supported in one rendering context are not necessarily available in a separate rendering context. Thus, for a given rendering context in an application, use the function addresses returned by the wglGetProcAddress function only</p>
</blockquote>
<p>So it&rsquo;s best to reload any extension procedures that we need.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ loading WGL extension procedures (again) for the real Gl context. */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* We reload the string extension procedure (as it&#39;s the only one we will reuse), and then load the rest of the WGL and GL procedures now that we have the real context. According to the MSDN docs for wglGetProcAddress(): &#34;Extension functions supported in one rendering context are not necessarily available in a separate rendering context. Thus, for a given rendering context in an application, use the function addresses returned by the wglGetProcAddress function only.&#34;. In practice, we may not need to do this, but as a matter of *good* practice we should. */</span>
</span></span><span class="line"><span class="cl"><span class="n">wglGetExtensionsStringARB</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">wglGetExtensionsStringARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLGETEXTENSIONSSTRINGARBPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglGetExtensionsStringARB&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglGetExtensionsStringARB</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load wglGetExtensionsStringARB()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">extensions_string</span> <span class="o">=</span> <span class="nf">wglGetExtensionsStringARB</span><span class="p">(</span><span class="n">window_DC</span><span class="p">);</span> <span class="cm">/* grabbing the extensions again */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLSWAPINTERVALEXTPROC</span> <span class="n">wglSwapIntervalEXT</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNWGLGETSWAPINTERVALEXTPROC</span> <span class="n">wglGetSwapIntervalEXT</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* it&#39;s not necessary to require that these extensions be present, we could leave it as an optional feature, but for our program, we will require them. */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">Check_Extension_Available</span><span class="p">(</span><span class="n">extensions_string</span><span class="p">,</span> <span class="s">&#34;WGL_EXT_swap_control&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: WGL_EXT_swap_control extension not found</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">Check_Extension_Available</span><span class="p">(</span><span class="n">extensions_string</span><span class="p">,</span> <span class="s">&#34;WGL_EXT_swap_control_tear&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: WGL_EXT_swap_control_tear extension not found</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">wglSwapIntervalEXT</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLSWAPINTERVALEXTPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglSwapIntervalEXT&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">wglGetSwapIntervalEXT</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLGETSWAPINTERVALEXTPROC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Load_WGL_Proc</span><span class="p">(</span><span class="s">&#34;wglGetSwapIntervalEXT&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglSwapIntervalEXT</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglSwapIntervalEXT</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">wglGetSwapIntervalEXT</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to load proc: </span><span class="se">\&#34;</span><span class="s">wglGetSwapIntervalEXT</span><span class="se">\&#34;\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>In this case, we also load <code>wglSwapIntervalEXT()</code> which is used to set v-sync.</p>

<h3 class="relative group">Loading GL procedures
    <div id="loading-gl-procedures" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#loading-gl-procedures" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Let&rsquo;s also load some GL procedures that we might need for a typical short OpenGL &ldquo;hello triangle&rdquo; application:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ Loading OpenGL procedures (we need the &#34;glext.h&#34; header for the function typedefs and declarations). */</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLGETSTRINGIPROC</span> <span class="n">glGetStringi</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLGENBUFFERSPROC</span> <span class="n">glGenBuffers</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLBINDBUFFERPROC</span> <span class="n">glBindBuffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLBUFFERDATAPROC</span> <span class="n">glBufferData</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLCREATESHADERPROC</span> <span class="n">glCreateShader</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLSHADERSOURCEPROC</span> <span class="n">glShaderSource</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLCOMPILESHADERPROC</span> <span class="n">glCompileShader</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLCREATEPROGRAMPROC</span> <span class="n">glCreateProgram</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLATTACHSHADERPROC</span> <span class="n">glAttachShader</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLLINKPROGRAMPROC</span> <span class="n">glLinkProgram</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLDELETESHADERPROC</span> <span class="n">glDeleteShader</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLUSEPROGRAMPROC</span> <span class="n">glUseProgram</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLVERTEXATTRIBPOINTERPROC</span> <span class="n">glVertexAttribPointer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLENABLEVERTEXATTRIBARRAYPROC</span> <span class="n">glEnableVertexAttribArray</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLGENVERTEXARRAYSPROC</span> <span class="n">glGenVertexArrays</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">PFNGLBINDVERTEXARRAYPROC</span> <span class="n">glBindVertexArray</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">glGetStringi</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLGETSTRINGIPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glGetStringi&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glGenBuffers</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLGENBUFFERSPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glGenBuffers&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glBindBuffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLBINDBUFFERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glBindBuffer&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glBufferData</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLBUFFERDATAPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glBufferData&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glCreateShader</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLCREATESHADERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glCreateShader&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glShaderSource</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLSHADERSOURCEPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glShaderSource&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glCompileShader</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLCOMPILESHADERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glCompileShader&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glCreateProgram</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLCREATEPROGRAMPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glCreateProgram&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glAttachShader</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLATTACHSHADERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glAttachShader&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glLinkProgram</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLLINKPROGRAMPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glLinkProgram&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glDeleteShader</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLDELETESHADERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glDeleteShader&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glUseProgram</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLUSEPROGRAMPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glUseProgram&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glVertexAttribPointer</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLVERTEXATTRIBPOINTERPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glVertexAttribPointer&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glEnableVertexAttribArray</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLENABLEVERTEXATTRIBARRAYPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glEnableVertexAttribArray&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glGenVertexArrays</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLGENVERTEXARRAYSPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glGenVertexArrays&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">glBindVertexArray</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLBINDVERTEXARRAYPROC</span><span class="p">)</span><span class="nf">Load_WGL_Proc</span><span class="p">((</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&#34;glBindVertexArray&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glGetStringi</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glGetStringi</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glGenBuffers</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glGenBuffers</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glBindBuffer</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glBindBuffer</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glBufferData</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glBufferData</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glCreateShader</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glCreateShader</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glShaderSource</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glShaderSource</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glCompileShader</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glCompileShader</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glCreateProgram</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glCreateProgram</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glAttachShader</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glAttachShader</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glLinkProgram</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glLinkProgram</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glDeleteShader</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glDeleteShader</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glUseProgram</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glUseProgram</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glVertexAttribPointer</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glVertexAttribPointer</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glEnableVertexAttribArray</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glEnableVertexAttribArray</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glGenVertexArrays</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glGenVertexArrays</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">glBindVertexArray</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: </span><span class="se">\&#34;</span><span class="s">glBindVertexArray</span><span class="se">\&#34;</span><span class="s"> function pointer NULL</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>This code makes use of the <code>Load_WGL_Proc()</code> wrapper function that we wrote beforehand.</p>

<h2 class="relative group">Setting up Hello Triangle
    <div id="setting-up-hello-triangle" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#setting-up-hello-triangle" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Once we have the GL functions loaded, we can actually start doing some OpenGL rendering. Here is some code for creating a basic &ldquo;hello triangle&rdquo; that we will render:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ setting up rendering of hello triangle */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define VERT_SIZE 9
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">GLfloat</span> <span class="n">vertices</span><span class="p">[</span><span class="n">VERT_SIZE</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">vertices</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @TODO: use the new glCreateBuffers() and glNamedBufferStorage() and see if that works! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">vert_shader_source</span> <span class="o">=</span> <span class="s">&#34;#version 460 core</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;layout (location = 0) in vec3 vpos;</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;void main()</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;{</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;gl_Position = vec4(vpos.x, vpos.y, vpos.z, 1.0);</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;}</span><span class="se">\n\0</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">frag_shader_source</span> <span class="o">=</span> <span class="s">&#34;#version 460 core</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;out vec4 frag_color;</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;void main()</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;{</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;frag_color = vec4(0.1f, 0.7f, 0.5f, 1.0f);</span><span class="se">\n</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;}</span><span class="se">\n\0</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GLuint</span> <span class="n">vert_shader</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">GLuint</span> <span class="n">frag_shader</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">GLuint</span> <span class="n">shader_program</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">vert_shader</span> <span class="o">=</span> <span class="nf">glCreateShader</span><span class="p">(</span><span class="n">GL_VERTEX_SHADER</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">frag_shader</span> <span class="o">=</span> <span class="nf">glCreateShader</span><span class="p">(</span><span class="n">GL_FRAGMENT_SHADER</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">shader_program</span> <span class="o">=</span> <span class="nf">glCreateProgram</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glShaderSource</span><span class="p">(</span><span class="n">vert_shader</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">vert_shader_source</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glShaderSource</span><span class="p">(</span><span class="n">frag_shader</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">frag_shader_source</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glCompileShader</span><span class="p">(</span><span class="n">vert_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glCompileShader</span><span class="p">(</span><span class="n">frag_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glAttachShader</span><span class="p">(</span><span class="n">shader_program</span><span class="p">,</span> <span class="n">vert_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glAttachShader</span><span class="p">(</span><span class="n">shader_program</span><span class="p">,</span> <span class="n">frag_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glLinkProgram</span><span class="p">(</span><span class="n">shader_program</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glDeleteShader</span><span class="p">(</span><span class="n">vert_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glDeleteShader</span><span class="p">(</span><span class="n">frag_shader</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">GLuint</span> <span class="n">vao</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">GLuint</span> <span class="n">vbo</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nf">glGenVertexArrays</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">vao</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glGenBuffers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">vbo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glBindVertexArray</span><span class="p">(</span><span class="n">vao</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glBindBuffer</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="n">vbo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glBufferData</span><span class="p">(</span><span class="n">GL_ARRAY_BUFFER</span><span class="p">,</span> <span class="n">VERT_SIZE</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">GLfloat</span><span class="p">),</span> <span class="p">(</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">vertices</span><span class="p">,</span> <span class="n">GL_STATIC_DRAW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glVertexAttribPointer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">GL_FLOAT</span><span class="p">,</span> <span class="n">GL_FALSE</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">GLfloat</span><span class="p">),</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nf">glEnableVertexAttribArray</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>Once this is done, we&rsquo;ll be able to render a simple triangle to the screen in our main loop, which we&rsquo;ll talk about next.</p>
<p>Before we do that, we should set the GL viewport with <code>glViewport()</code> and also show our window with <code>ShowWindow()</code> so that it is visible:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ setting glViewport() */</span>
</span></span><span class="line"><span class="cl"><span class="n">RECT</span> <span class="n">window_size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nf">GetClientRect</span><span class="p">(</span><span class="n">window_handle</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">window_size</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">glViewport</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">window_size</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">.</span><span class="n">left</span><span class="p">,</span> <span class="n">window_size</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">.</span><span class="n">top</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/* @@ Finally at the end, we show the window, similar to XMapRaised() or XMapWindow() for X11 */</span>
</span></span><span class="line"><span class="cl"><span class="nf">ShowWindow</span><span class="p">(</span><span class="n">window_handle</span><span class="p">,</span> <span class="n">SW_SHOWNORMAL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>The window is technically visible at this point, but the application will return almost as soon as it starts so we might not see it. To see our window (and also render the triangle), we need to write the main loop.</p>

<h3 class="relative group">Main Event/Message Loop &amp; Cleanup
    <div id="main-eventmessage-loop--cleanup" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#main-eventmessage-loop--cleanup" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Now we need to write the main event or message loop which will process window messages and also do rendering.</p>
<p>The code is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ main loop */</span>
</span></span><span class="line"><span class="cl"><span class="n">MSG</span> <span class="n">msg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span><span class="p">(</span><span class="n">program_running</span><span class="p">)</span> <span class="p">{</span>	    
</span></span><span class="line"><span class="cl">      <span class="cm">/* @@ flush/process/get messages */</span>
</span></span><span class="line"><span class="cl">      <span class="k">while</span><span class="p">(</span><span class="nf">PeekMessageA</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PM_REMOVE</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	    <span class="k">if</span><span class="p">(</span><span class="nf">LOWORD</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">message</span><span class="p">)</span> <span class="o">==</span> <span class="n">WM_QUIT</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		  <span class="n">program_running</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		  <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	    <span class="nf">TranslateMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>		  
</span></span><span class="line"><span class="cl">	    <span class="nf">DispatchMessage</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="cm">/* @@ rendering */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glClearColor</span><span class="p">(</span><span class="mf">0.1f</span><span class="p">,</span> <span class="mf">0.15f</span><span class="p">,</span> <span class="mf">0.19f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glClear</span><span class="p">(</span><span class="n">GL_COLOR_BUFFER_BIT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glUseProgram</span><span class="p">(</span><span class="n">shader_program</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glBindVertexArray</span><span class="p">(</span><span class="n">vao</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glDrawArrays</span><span class="p">(</span><span class="n">GL_TRIANGLES</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="cm">/* @@ swapping and synching */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">wglSwapLayerBuffers</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="n">WGL_SWAP_MAIN_PLANE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">glFinish</span><span class="p">();</span> <span class="cm">/* blocks until all previous GL commands finish, including the buffer swap. */</span>
</span></span><span class="line"><span class="cl">      <span class="cm">/* @! */</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>There&rsquo;s not much that&rsquo;s different here than on other platforms, besides of course the <code>PeekMessageA()</code> message loop. Basically, we get all the messages of the queue and process them one-by-one. <code>DispatchMessageA()</code> is the function that actually sends our message to the window procedure <code>WindowProc()</code>. Keep in mind that not all messages are sent with <code>DispatchMessageA()</code>, many are just sent directly to the window procedure.</p>
<p>Lastly, once the main loop exits, we need to cleanup everything and return:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/* @@ Cleanup and Exit */</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglMakeCurrent</span><span class="p">(</span><span class="n">window_DC</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* making WGL context not current */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglMakeCurrent() failed to make context NOT current</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">wglDeleteContext</span><span class="p">(</span><span class="n">wgl_context</span><span class="p">)</span> <span class="o">!=</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* deleting WGL context */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: wglDeleteContext() failed to delete WGL context</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">DeleteDC</span><span class="p">(</span><span class="n">window_DC</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* deleting window device context */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: DeleteDC() failed to delete window Device Context</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">DestroyWindow</span><span class="p">(</span><span class="n">window_handle</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">DWORD</span> <span class="n">win32_error_val</span> <span class="o">=</span> <span class="nf">GetLastError</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: failed to destroy window with DestroyWindow() - win32 error code: %ld</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">win32_error_val</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nf">UnregisterClassA</span><span class="p">(</span><span class="n">window_class_name</span><span class="p">,</span> <span class="n">hInstance</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* unregistering window class */</span>
</span></span><span class="line"><span class="cl">      <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;ERROR: UnregisterClassA() failed to unregister window class: %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">window_class_name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* @! */</span>
</span></span></code></pre></div><p>And that&rsquo;s it! Once you have this working, you&rsquo;re on your way to program native OpenGL applications on windows!</p>

<h2 class="relative group">Source Code
    <div id="source-code" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#source-code" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>As promised, the full source code (and more) is provided in my <a
  href="https://github.com/James822/win32-opengl-window"
    target="_blank"
  >github repo</a>. Feel free to use it as you wish. There&rsquo;s some minor differences, namely there&rsquo;s a section of code that turns on fullscreen which I left out in the tutorial here as I viewed that to be windows-specific and not really related to OpenGL.</p>

<h2 class="relative group">References
    <div id="references" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#references" aria-label="Anchor">#</a>
    </span>
    
</h2>
<ul>
<li>MSDN tutorial for using MSVC on the command line: <a
  href="https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170"
    target="_blank"
  >https://learn.microsoft.com/en-us/cpp/build/building-on-the-command-line?view=msvc-170</a></li>
<li>Build Tools for Visual Studio: <a
  href="https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022"
    target="_blank"
  >https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2022</a></li>
<li>Khronos OpenGL registry: <a
  href="https://registry.khronos.org/OpenGL/index_gl.php"
    target="_blank"
  >https://registry.khronos.org/OpenGL/index_gl.php</a></li>
<li>Khronos Opengl Context Creation Tutorial: <a
  href="https://www.khronos.org/opengl/wiki/Tutorial:_OpenGL_3.0_Context_Creation_%28GLX%29"
    target="_blank"
  >https://www.khronos.org/opengl/wiki/Tutorial:<em>OpenGL_3.0_Context_Creation</em>(GLX)</a></li>
<li>Khronos tutorial on loading OpenGL functions: (<a
  href="https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions%29[https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions]"
    target="_blank"
  >https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions)[https://www.khronos.org/opengl/wiki/Load_OpenGL_Functions]</a></li>
<li>WINE list of windows messages: <a
  href="https://gitlab.winehq.org/wine/wine/-/wikis/Wine-Developer%27s-Guide/List-of-Windows-Messages"
    target="_blank"
  >https://gitlab.winehq.org/wine/wine/-/wikis/Wine-Developer&rsquo;s-Guide/List-of-Windows-Messages</a></li>
<li>WINE implementation of default window procedure: <a
  href="https://gitlab.winehq.org/wine/wine/-/blob/master/dlls/win32u/defwnd.c#L2388"
    target="_blank"
  >https://gitlab.winehq.org/wine/wine/-/blob/master/dlls/win32u/defwnd.c#L2388</a></li>
<li>The amazing and classic learnOpenGL tutorial: <a
  href="https://learnopengl.com/"
    target="_blank"
  >https://learnopengl.com/</a></li>
</ul>

          
          
          
            <strong class="block mt-8">
              <a
                target="_blank"
                class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
                href="mailto:JamesSpratt.business@protonmail.com?subject=Reply%20to%20Creating%20a%20win32%20Window%20and%20OpenGL%20Context%20on%20Windows%20From%20Scratch">
                Reply by Email
              </a>
            </strong>
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts/win32_window_opengl.md"
          data-oid-likes="likes_posts/win32_window_opengl.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/x11_window_opengl/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Creating an X11 Window and OpenGL Context on Linux From Scratch
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2025-04-05T00:00:00&#43;00:00">5 April 2025</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          James Spratt
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://james822.github.io/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
